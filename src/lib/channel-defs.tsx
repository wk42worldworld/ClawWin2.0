import React from 'react'

/* ─── SVG Logos ─── */
const TelegramLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69.01-.03.01-.14-.07-.2-.08-.06-.19-.04-.28-.02-.12.03-2.02 1.28-5.69 3.77-.54.37-1.03.55-1.47.54-.48-.01-1.4-.27-2.09-.49-.84-.28-1.51-.42-1.45-.89.03-.25.38-.5 1.04-.76 4.09-1.78 6.82-2.96 8.2-3.52 3.9-1.63 4.71-1.91 5.23-1.92.12 0 .37.03.54.17.14.12.18.28.2.47-.01.06.01.24 0 .37z" fill="#26A5E4"/>
  </svg>
)
const WhatsAppLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <path d="M17.47 14.38c-.29-.14-1.7-.84-1.96-.93-.27-.1-.46-.15-.66.14-.2.29-.76.93-.93 1.12-.17.2-.34.22-.63.07-.29-.14-1.22-.45-2.33-1.43-.86-.77-1.44-1.71-1.61-2-.17-.29-.02-.45.13-.59.13-.13.29-.34.44-.51.14-.17.2-.29.29-.48.1-.2.05-.37-.02-.51-.07-.15-.66-1.58-.9-2.16-.24-.57-.48-.49-.66-.5h-.56c-.2 0-.51.07-.78.37-.27.29-1.02 1-1.02 2.43s1.05 2.82 1.19 3.01c.15.2 2.06 3.14 4.99 4.41.7.3 1.24.48 1.66.61.7.22 1.34.19 1.84.12.56-.08 1.7-.7 1.94-1.37.24-.68.24-1.26.17-1.38-.07-.12-.27-.19-.56-.34zm-5.44 7.44h-.02a9.87 9.87 0 01-5.03-1.38l-.36-.22-3.74.98 1-3.65-.23-.37A9.86 9.86 0 012.18 12c0-5.45 4.44-9.89 9.9-9.89a9.89 9.89 0 019.89 9.9c0 5.45-4.44 9.89-9.9 9.89l-.04-.01zM12.04 0C5.39 0 0 5.39 0 12.04c0 2.12.56 4.19 1.61 6.01L0 24l6.12-1.6A12.02 12.02 0 0012.04 24C18.69 24 24 18.62 24 12.04 24 5.39 18.62 0 12.04 0z" fill="#25D366"/>
  </svg>
)
const DiscordLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <path d="M20.32 4.37a19.8 19.8 0 00-4.89-1.52.07.07 0 00-.08.04c-.21.38-.44.87-.61 1.26a18.27 18.27 0 00-5.49 0 12.64 12.64 0 00-.62-1.26.07.07 0 00-.08-.04 19.74 19.74 0 00-4.89 1.52.07.07 0 00-.03.03C1.28 8.22.63 11.96.98 15.65a.08.08 0 00.03.06 19.9 19.9 0 005.99 3.03.08.08 0 00.08-.03c.46-.63.87-1.3 1.22-2a.08.08 0 00-.04-.1 13.1 13.1 0 01-1.87-.9.08.08 0 01-.01-.12c.13-.09.25-.19.37-.29a.07.07 0 01.08-.01c3.93 1.8 8.18 1.8 12.07 0a.07.07 0 01.08.01c.12.1.25.2.37.29a.08.08 0 01-.01.12c-.6.35-1.22.65-1.87.9a.08.08 0 00-.04.1c.36.7.77 1.37 1.22 2a.07.07 0 00.08.03 19.84 19.84 0 006-3.03.08.08 0 00.03-.05c.42-4.34-.7-8.04-2.96-11.35a.06.06 0 00-.03-.03zM8.02 13.33c-.98 0-1.79-.9-1.79-2.01s.79-2.01 1.79-2.01c1.01 0 1.8.91 1.79 2.01 0 1.11-.79 2.01-1.79 2.01zm6.62 0c-.98 0-1.79-.9-1.79-2.01s.79-2.01 1.79-2.01c1.01 0 1.8.91 1.79 2.01 0 1.11-.78 2.01-1.79 2.01z" fill="#5865F2"/>
  </svg>
)
const FeishuLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <path d="M5.57 4.05c-.55-.78-.56-1.73-.05-2.15.14-.12.32-.15.48-.12 2.73.56 5.18 2.03 7.03 4.16l.44.52c.38.46.86 1.04 1.41 1.78L5.57 4.05z" fill="#00D6B9"/>
    <path d="M19.24 9.9a16.52 16.52 0 00-4.87-5.36c-.58-.44-1.12-.82-1.6-1.13l-.52-.33c1.94 2.87 2.95 6.28 2.86 9.75-.01.47-.04.93-.09 1.38l-.02.15c-.08.6-.2 1.2-.36 1.78l4.84-3.91c.67-.54.67-1.56-.24-2.33z" fill="#3370FF"/>
    <path d="M14.7 16.52c-.58 1.39-1.42 2.65-2.48 3.72a11.5 11.5 0 01-3.84 2.6c-.48.2-1 .05-1.24-.39a1 1 0 01-.07-.78l2.82-8.28c.3-.86.67-1.7 1.1-2.5a17.4 17.4 0 012.34-3.36c.2.25.41.52.63.82a20.62 20.62 0 011.83 3.21c.52 1.16.87 2.32.87 2.32-.23.92-.53 1.83-.96 2.64z" fill="#3370FF"/>
  </svg>
)
const SlackLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <path d="M5.04 15.16a2.1 2.1 0 01-2.1 2.1A2.1 2.1 0 01.84 15.16a2.1 2.1 0 012.1-2.1h2.1v2.1zm1.06 0a2.1 2.1 0 012.1-2.1 2.1 2.1 0 012.1 2.1v5.25a2.1 2.1 0 01-2.1 2.1 2.1 2.1 0 01-2.1-2.1v-5.25z" fill="#E01E5A"/>
    <path d="M8.2 5.04a2.1 2.1 0 01-2.1-2.1A2.1 2.1 0 018.2.84a2.1 2.1 0 012.1 2.1v2.1H8.2zm0 1.07a2.1 2.1 0 012.1 2.1 2.1 2.1 0 01-2.1 2.1H2.94a2.1 2.1 0 01-2.1-2.1 2.1 2.1 0 012.1-2.1H8.2z" fill="#36C5F0"/>
    <path d="M18.36 8.2a2.1 2.1 0 012.1-2.1 2.1 2.1 0 012.1 2.1 2.1 2.1 0 01-2.1 2.1h-2.1V8.2zm-1.07 0a2.1 2.1 0 01-2.1 2.1 2.1 2.1 0 01-2.1-2.1V2.94a2.1 2.1 0 012.1-2.1 2.1 2.1 0 012.1 2.1V8.2z" fill="#2EB67D"/>
    <path d="M15.2 18.36a2.1 2.1 0 012.1 2.1 2.1 2.1 0 01-2.1 2.1 2.1 2.1 0 01-2.1-2.1v-2.1h2.1zm0-1.07a2.1 2.1 0 01-2.1-2.1 2.1 2.1 0 012.1-2.1h5.25a2.1 2.1 0 012.1 2.1 2.1 2.1 0 01-2.1 2.1H15.2z" fill="#ECB22E"/>
  </svg>
)
const GoogleChatLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <path d="M22 11.08V12a10 10 0 11-5.93-9.14" stroke="#34A853" strokeWidth="2" strokeLinecap="round"/>
    <path d="M22 4L12 14.01l-3-3" stroke="#34A853" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
    <rect x="6" y="9" width="5" height="2" rx="1" fill="#4285F4"/>
    <rect x="6" y="13" width="8" height="2" rx="1" fill="#FBBC05"/>
  </svg>
)
const SignalLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <path d="M12 2C6.48 2 2 6.48 2 12c0 1.85.5 3.58 1.38 5.07L2 22l4.93-1.38A9.96 9.96 0 0012 22c5.52 0 10-4.48 10-10S17.52 2 12 2z" fill="#3A76F0"/>
    <circle cx="8.5" cy="12" r="1.5" fill="white"/>
    <circle cx="12" cy="12" r="1.5" fill="white"/>
    <circle cx="15.5" cy="12" r="1.5" fill="white"/>
  </svg>
)
const IMessageLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <path d="M12 2C6.477 2 2 5.813 2 10.5c0 2.34 1.094 4.46 2.875 6.031-.188 1.375-.875 2.625-.875 2.625s2.563-.313 4.063-1.281A12.1 12.1 0 0012 19c5.523 0 10-3.813 10-8.5S17.523 2 12 2z" fill="#34C759"/>
  </svg>
)
const LineLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <path d="M12 2C6.48 2 2 5.83 2 10.45c0 4.18 3.7 7.68 8.7 8.34.34.07.8.22.91.51.1.26.07.67.03.94l-.15.88c-.04.26-.2 1.01.89.55.59-.25 3.2-1.89 4.36-3.23C18.68 15.93 22 13.46 22 10.45 22 5.83 17.52 2 12 2z" fill="#06C755"/>
    <path d="M8.53 8.87H7.72a.28.28 0 00-.28.28v3.42c0 .15.12.28.28.28h.81c.15 0 .28-.13.28-.28V9.15a.28.28 0 00-.28-.28zm7.72 0h-.81a.28.28 0 00-.28.28v2.03l-1.15-2.18a.28.28 0 00-.25-.13h-.81a.28.28 0 00-.28.28v3.42c0 .15.12.28.28.28h.81c.15 0 .28-.13.28-.28v-2.03l1.15 2.18c.04.08.13.13.25.13h.81c.15 0 .28-.13.28-.28V9.15a.28.28 0 00-.28-.28zm-5.09 0h-.81a.28.28 0 00-.28.28v3.42c0 .15.12.28.28.28h.81c.15 0 .28-.13.28-.28V9.15a.28.28 0 00-.28-.28zm-2.03 2.77H7.97V9.15a.28.28 0 00-.28-.28h-.81a.28.28 0 00-.28.28v3.42c0 .15.12.28.28.28h2.25c.15 0 .28-.13.28-.28v-.65a.28.28 0 00-.28-.28z" fill="white"/>
  </svg>
)
const DingTalkLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <rect width="24" height="24" rx="4" fill="#0089FF"/>
    <path d="M17.62 12.24c-.1-.04-1.72-.67-1.95-.75-.23-.08-.44-.12-.56.12-.15.27-.52.74-.65.9-.12.14-.25.16-.46.06-.22-.1-.9-.34-1.72-1.06-.64-.57-1.07-1.27-1.19-1.48-.13-.22-.01-.33.1-.44.1-.1.22-.25.33-.38.1-.13.14-.22.22-.36.07-.15.03-.27-.02-.38-.05-.1-.55-1.35-.76-1.84-.2-.48-.4-.42-.56-.42h-.47c-.16 0-.42.06-.65.3-.22.23-.86.84-.86 2.05s.88 2.38 1 2.54c.13.16 1.75 2.67 4.23 3.74.59.26 1.05.41 1.41.52.59.19 1.13.16 1.56.1.48-.07 1.46-.6 1.67-1.17.2-.58.2-1.07.14-1.17-.06-.1-.22-.16-.46-.27z" fill="white"/>
  </svg>
)
const WeChatLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <path d="M8.69 3C4.96 3 2 5.57 2 8.73c0 1.77.93 3.36 2.38 4.42L3.88 15l1.98-.99c.63.23 1.3.38 2.01.44a5.9 5.9 0 01-.18-1.42C7.69 9.9 10.31 7.3 13.6 7.3c.36 0 .71.03 1.05.08C14.01 4.87 11.62 3 8.69 3z" fill="#51C332"/>
    <circle cx="6.8" cy="7.5" r=".85" fill="white"/>
    <circle cx="10.5" cy="7.5" r=".85" fill="white"/>
    <path d="M22 13.03c0-2.64-2.65-4.78-5.91-4.78s-5.91 2.14-5.91 4.78c0 2.64 2.65 4.78 5.91 4.78.65 0 1.27-.09 1.85-.25l1.66.83-.38-1.56C20.87 16 22 14.62 22 13.03z" fill="#51C332"/>
    <circle cx="14.2" cy="12.5" r=".7" fill="white"/>
    <circle cx="17.8" cy="12.5" r=".7" fill="white"/>
  </svg>
)
const QQLogo = () => (
  <svg viewBox="0 0 24 24" width="28" height="28" fill="none">
    <path d="M12 2C7.2 2 4 5.36 4 9.6c0 1.52.32 2.96.88 4.24-.28.88-.72 1.76-.88 2.16.56.24 1.48-.08 2.16-.4.64.88 1.2 1.52 1.6 1.84-.08.4-.24 1.04-.24 1.36.64.16 1.44-.24 2-.56C10.28 18.72 11.04 19 12 19s1.72-.28 2.48-.76c.56.32 1.36.72 2 .56 0-.32-.16-.96-.24-1.36.4-.32.96-.96 1.6-1.84.68.32 1.6.64 2.16.4-.16-.4-.6-1.28-.88-2.16.56-1.28.88-2.72.88-4.24C20 5.36 16.8 2 12 2z" fill="#12B7F5"/>
    <ellipse cx="9.5" cy="9" rx="1.2" ry="1.5" fill="white"/>
    <ellipse cx="14.5" cy="9" rx="1.2" ry="1.5" fill="white"/>
    <ellipse cx="9.5" cy="9.2" rx=".6" ry=".8" fill="#333"/>
    <ellipse cx="14.5" cy="9.2" rx=".6" ry=".8" fill="#333"/>
  </svg>
)

/** 飞书权限批量导入 JSON（来自 openclaw-feishu 官方指南） */
export const FEISHU_PERMISSIONS_JSON = `{
  "scopes": {
    "tenant": [
      "aily:file:read",
      "aily:file:write",
      "application:application.app_message_stats.overview:readonly",
      "application:application:self_manage",
      "application:bot.menu:write",
      "cardkit:card:write",
      "contact:user.employee_id:readonly",
      "corehr:file:download",
      "docs:document.content:read",
      "event:ip_list",
      "im:chat",
      "im:chat.access_event.bot_p2p_chat:read",
      "im:chat.members:bot_access",
      "im:message",
      "im:message.group_at_msg:readonly",
      "im:message.group_msg",
      "im:message.p2p_msg:readonly",
      "im:message:readonly",
      "im:message:send_as_bot",
      "im:resource",
      "sheets:spreadsheet",
      "wiki:wiki:readonly"
    ],
    "user": [
      "aily:file:read",
      "aily:file:write",
      "im:chat.access_event.bot_p2p_chat:read"
    ]
  }
}`

/** 渠道定义 */
export interface ChannelDef {
  id: string
  label: string
  blurb: string
  logo: React.FC
  fields: { key: string; label: string; placeholder: string; required: boolean }[]
  disabled?: boolean
  disabledReason?: string
  tutorialSteps?: string[]
  /** 权限批量导入 JSON，在教程弹窗中显示"复制权限配置"按钮 */
  permissionsJson?: string
}

export const CHANNELS: ChannelDef[] = [
  {
    id: 'telegram',
    label: 'Telegram',
    blurb: '使用 @BotFather 注册一个机器人并开始使用',
    logo: TelegramLogo,
    tutorialSteps: [
      '打开 Telegram，搜索 @BotFather 并发送 /newbot',
      '按提示输入机器人名称和用户名（用户名需以 bot 结尾）',
      'BotFather 会返回一个 Bot Token（格式如 123456:ABC-DEF...）',
      '将 Bot Token 粘贴到下方输入框，启用频道',
      '启动 ClawWin 后，在 Telegram 中搜索你的机器人',
      '向机器人发送任意消息，机器人会自动回复 8 位配对码',
      '回到 ClawWin 聊天工具面板 → 配对管理，输入配对码并批准',
      '批准后即可正常与机器人对话',
    ],
    fields: [
      { key: 'botToken', label: 'Bot Token', placeholder: '123456:ABC-DEF...', required: true },
    ],
  },
  {
    id: 'whatsapp',
    label: 'WhatsApp',
    blurb: '使用您自己的号码工作，运行时通过 QR 码配对',
    logo: WhatsAppLogo,
    tutorialSteps: [
      '启用 WhatsApp 频道（无需填写任何配置）',
      '保存后，点击 WhatsApp 卡片上的"扫码连接"按钮',
      '打开手机 WhatsApp → 设置 → 已关联设备 → 关联设备',
      '用手机扫描界面上显示的 QR 码完成关联',
      '关联成功后，用户向你的 WhatsApp 号码发送任意消息，机器人会自动回复 8 位配对码',
      '回到 ClawWin 聊天工具面板 → 配对管理，输入配对码并批准',
      '批准后即可正常与 AI 对话',
    ],
    fields: [],
  },
  {
    id: 'discord',
    label: 'Discord',
    blurb: '通过 Discord Bot API 集成',
    logo: DiscordLogo,
    tutorialSteps: [
      '访问 discord.com/developers/applications，点击 New Application 创建应用',
      '进入应用 → Bot 页面，点击 Reset Token 获取 Bot Token',
      '在 Bot 页面下方找到 Privileged Gateway Intents，开启「Message Content Intent」开关（允许机器人读取消息内容）',
      '进入 OAuth2 → URL Generator，勾选 bot，在下方权限中勾选 Send Messages 和 Read Message History，复制生成的链接在浏览器打开，将机器人邀请到你的服务器',
      '将 Bot Token 粘贴到下方输入框，启用频道',
      '启动 ClawWin 后，在 Discord 服务器中向机器人发送任意消息，机器人会自动回复 8 位配对码',
      '回到 ClawWin 聊天工具面板 → 配对管理，输入配对码并批准',
      '批准后即可 @你的机器人 正常对话',
    ],
    fields: [
      { key: 'token', label: 'Bot Token', placeholder: 'MTk...', required: true },
    ],
  },
  {
    id: 'feishu',
    label: '飞书 / Lark',
    blurb: '飞书/Lark 开放平台 WebSocket 机器人集成',
    logo: FeishuLogo,
    tutorialSteps: [
      '访问 open.feishu.cn → 开发者后台 → 创建企业自建应用',
      '进入应用 → 凭证与基础信息，复制 App ID 和 App Secret',
      '进入 添加应用能力 → 添加「机器人」能力',
      '进入 权限管理 → 点击「批量导入」，粘贴下方权限配置 JSON 一键导入所有权限',
      '将 App ID 和 App Secret 粘贴到下方输入框（如有 Encrypt Key / Verification Token 也一并填入），开启开关并点击保存',
      '保存后 ClawWin 会自动连接飞书（通过 WebSocket 长连接），等待连接成功',
      '回到飞书开发者后台 → 事件与回调 → 确认长连接模式已生效，添加「接收消息」事件（im.message.receive_v1）',
      '发布应用版本，管理员审批通过后，在飞书中搜索机器人名称',
      '首次使用时向机器人发送任意消息，机器人会自动回复 8 位配对码',
      '回到 ClawWin 聊天工具面板 → 配对管理，输入配对码并批准',
      '批准后即可正常与机器人对话',
    ],
    permissionsJson: FEISHU_PERMISSIONS_JSON,
    fields: [
      { key: 'appId', label: 'App ID', placeholder: 'cli_xxx', required: true },
      { key: 'appSecret', label: 'App Secret', placeholder: '请输入 App Secret', required: true },
      { key: 'encryptKey', label: 'Encrypt Key', placeholder: '请输入 Encrypt Key（可选）', required: false },
      { key: 'verificationToken', label: 'Verification Token', placeholder: '请输入 Verification Token（可选）', required: false },
    ],
  },
  {
    id: 'slack',
    label: 'Slack',
    blurb: '通过 Socket Mode 连接 Slack 工作区',
    logo: SlackLogo,
    tutorialSteps: [
      '访问 api.slack.com/apps → Create New App → From scratch，创建一个新应用',
      '左侧菜单进入 Socket Mode 并启用，点击生成一个 App-Level Token（权限选 connections:write），复制 xapp-... 开头的 Token',
      '左侧菜单进入 OAuth & Permissions，在 Bot Token Scopes 中添加以下权限：chat:write（发消息）、app_mentions:read（读取@提及）、im:history（私聊历史）、im:read（读私聊）、im:write（写私聊）',
      '左侧菜单进入 Event Subscriptions 并启用，在 Subscribe to bot events 中添加：app_mention（被@时触发）和 message.im（收到私聊时触发）',
      '点击页面顶部 Install to Workspace 将应用安装到工作区，安装后复制 xoxb-... 开头的 Bot Token',
      '将 Bot Token 和 App Token 粘贴到下方输入框，启用频道',
      '启动 ClawWin 后，在 Slack 中向机器人发送任意消息，机器人会自动回复 8 位配对码',
      '回到 ClawWin 聊天工具面板 → 配对管理，输入配对码并批准',
      '批准后即可 @你的机器人 或私聊正常对话',
    ],
    fields: [
      { key: 'botToken', label: 'Bot Token', placeholder: 'xoxb-...', required: true },
      { key: 'appToken', label: 'App Token', placeholder: 'xapp-...', required: true },
    ],
  },
  {
    id: 'googlechat',
    label: 'Google Chat',
    blurb: '需要公网服务器，不支持本地运行',
    logo: GoogleChatLogo,
    fields: [],
    disabled: true,
    disabledReason: '需要公网服务器',
  },
  {
    id: 'signal',
    label: 'Signal',
    blurb: '需要安装 signal-cli 和 Java 环境',
    logo: SignalLogo,
    fields: [],
    disabled: true,
    disabledReason: '需要 signal-cli',
  },
  {
    id: 'line',
    label: 'LINE',
    blurb: '通过 LINE Messaging API 集成',
    logo: LineLogo,
    tutorialSteps: [
      '访问 developers.line.biz → 创建 Provider → 创建 Messaging API Channel',
      '进入 Channel 设置 → Messaging API 页签',
      '在页面底部点击 Issue 生成 Channel Access Token（长期）',
      '复制 Channel Access Token 和 Channel Secret',
      '将 Token 和 Secret 粘贴到下方输入框，启用频道',
      '在 LINE 中搜索机器人名称或扫描 QR 码添加好友',
      '向机器人发送任意消息，机器人会自动回复 8 位配对码',
      '回到 ClawWin 聊天工具面板 → 配对管理，输入配对码并批准',
      '批准后即可正常对话',
    ],
    fields: [
      { key: 'channelAccessToken', label: 'Channel Access Token', placeholder: '请输入 Channel Access Token', required: true },
      { key: 'channelSecret', label: 'Channel Secret', placeholder: '请输入 Channel Secret', required: true },
    ],
  },
  {
    id: 'dingtalk',
    label: '钉钉',
    blurb: '钉钉开放平台 Stream 模式机器人',
    logo: DingTalkLogo,
    fields: [],
    disabled: true,
    disabledReason: '即将支持',
  },
  {
    id: 'wechat',
    label: '微信（企业微信）',
    blurb: '通过企业微信应用 API 接收和发送消息',
    logo: WeChatLogo,
    fields: [],
    disabled: true,
    disabledReason: '即将支持',
  },
  {
    id: 'qq',
    label: 'QQ',
    blurb: 'QQ 开放平台官方机器人 API',
    logo: QQLogo,
    fields: [],
    disabled: true,
    disabledReason: '即将支持',
  },
  {
    id: 'imessage',
    label: 'iMessage',
    blurb: '仅支持 macOS 系统',
    logo: IMessageLogo,
    fields: [],
    disabled: true,
    disabledReason: '仅限 macOS',
  },
]
